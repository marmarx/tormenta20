import{k as K,m as P,u as D,p as E,q as X,s as Y,v as Q,c as W,f as B,d as Z,w as ee,x as te,l as se}from"./selectInput-DUifFGXK.js";import{_ as F,c as h,o as c,g as j,i as H,F as A,t as N,j as y,a as p,x as g,C as U,r as C,q as x,f as w,e as $,b as L,u as k,n as I,w as z,D as le,E as G,G as J,H as oe,I as re}from"./index-CJ4xQOWJ.js";import"./pencil-CVtyaq_j.js";const ae={class:"input"},ne={key:0},ue=["for"],ce=["id","value","checked","onChange"],ie={__name:"checklist",props:{modelValue:Array,options:Array},emits:["update:modelValue"],setup(u,{emit:a}){const t=u,v=a,o=(m,e)=>{const r=e?[...t.modelValue,m]:t.modelValue.filter(_=>_!==m);v("update:modelValue",r)};return(m,e)=>(c(),h("div",ae,[m.$slots.default?(c(),h("p",ne,[H(m.$slots,"default",{},void 0,!0)])):j("",!0),(c(!0),h(A,null,N(u.options,r=>(c(),h("label",{key:`checkbox-${r}`,for:`checkbox-${r}`},[y(g(r||"em branco")+" ",1),p("input",{type:"checkbox",id:`checkbox-${r}`,value:r,checked:u.modelValue.includes(r),onChange:_=>o(r,_.target.checked)},null,40,ce),e[0]||(e[0]=p("span",{class:"checkmark"},null,-1))],8,ue))),128))]))}},de=F(ie,[["__scopeId","data-v-3bcbe2a7"]]),O=u=>U(`${u}FilterStore`,()=>{const a=(s,l=0,d)=>{if(!s.value)return[];const n=d.map(f=>f.id);return l?s.value.filter((f,V)=>!n.includes(V)):n.map(f=>s.value[f])},t=C(""),v=s=>{if(!s.value)return[];const l=P(t.value.trim().toLowerCase());if(!l)return s.value.map(n=>({...n,Nome:n.Nome.replace(/<\/?b>/g,"")}));const d=new RegExp(l,"gi");return s.value.filter(n=>P(n.Nome.toLowerCase()).includes(l)).map(n=>{let f=n.Nome.replace(/<\/?b>/g,""),V=P(f.toLowerCase()),b=f.split(""),M=[...V.matchAll(d)].map(T=>T.index);for(let T=M.length-1;T>=0;T--)b.splice(M[T]+t.value.length,0,"</b>"),b.splice(M[T],0,"<b>");return{...n,Nome:b.join("")}})},o=K[u],m=(s,l)=>s.value?!o.value[l]||o.value[l].length===0?s.value:s.value.filter(d=>Array.isArray(d[l])?d[l].some(n=>o.value[l].includes(n)):o.value[l].includes(d[l])):[],e=C([]),r=C([]),_=(s,l,d)=>(e.value=a(s,0,d),e.value=v(e),Object.keys(o.value).forEach(n=>e.value=m(e,n)),r.value=a(s,1,d),r.value=v(r),Object.keys(o.value).forEach(n=>r.value=m(r,n)),l?r.value:e.value),i=x(()=>e.value?e.value.length:0),S=x(()=>r.value?r.value.length:219);return{filterList:a,filterSearch:_,filterText:t,filterCheck:o,numberCharList:i,numberFullList:S}});D();const pe=E(),R=U("spellsStore",()=>{const u=C(null);C(null);const a=async()=>{if(!u.value){const o=await fetch("/db/spells.json").then(m=>m.json()).then(m=>(console.log("Spells JSON loaded successfully!"),m)).catch(m=>console.log(`Spells JSON failed to load:
`,m));u.value=o}return u.value},t=X.spells;Object.keys(t.value).forEach(o=>{t.value[o]=x(()=>{if(!u.value)return[];const m=[...new Set(u.value.flatMap(e=>Array.isArray(e[o])?e[o]:[e[o]]))];return Y.spells.hasOwnProperty(o)?m.sort(pe.sortCustom(o,"spells")):m.sort()})});const v=Q.spells;return{allSpells:u,spellProperties:t,spellEditKeys:v,fetchSpells:a}}),me={class:"overflow"},ve={__name:"filtros",props:{purpose:String},setup(u){const t=O(u.purpose)(),v=R(),o=E();return(m,e)=>(c(),w(B,{class:"grow"},{default:$(()=>[e[5]||(e[5]=p("h2",null,"Filtros",-1)),p("div",me,[L(W,{modelValue:k(t).filterText,"onUpdate:modelValue":e[0]||(e[0]=r=>k(t).filterText=r),style:{width:"100%","max-width":"unset"}},{default:$(()=>e[2]||(e[2]=[y("Nome")])),_:1},8,["modelValue"]),L(B,{class:"flex-wrap"},{default:$(()=>[(c(!0),h(A,null,N(k(v).spellProperties,(r,_)=>(c(),w(de,{options:r,modelValue:k(t).filterCheck[_],"onUpdate:modelValue":i=>k(t).filterCheck[_]=i},{default:$(()=>[y(g(_),1)]),_:2},1032,["options","modelValue","onUpdate:modelValue"]))),256)),L(Z,{options:k(ee)[u.purpose],modelValue:k(o).sortBy,"onUpdate:modelValue":e[1]||(e[1]=r=>k(o).sortBy=r),reverse:!0,style:{width:"100%","max-width":"unset"}},{title:$(()=>e[3]||(e[3]=[y("Ordenar")])),default:$(()=>e[4]||(e[4]=[y("Escolha como deseja ordenar...")])),_:1},8,["options","modelValue"])]),_:1})])]),_:1}))}},fe=F(ve,[["__scopeId","data-v-b0864298"]]),_e={class:"flex tab_container"},he={for:"tab1"},be={for:"tab2"},Se={__name:"tabs",emits:["tab"],setup(u){return(a,t)=>(c(),h("div",_e,[p("input",{type:"radio",id:"tab1",class:"tab",name:"tab",checked:"",onClick:t[0]||(t[0]=v=>a.$emit("tab",0))}),p("label",he,[H(a.$slots,"tab1",{},void 0,!0)]),p("input",{type:"radio",id:"tab2",class:"tab",name:"tab",onClick:t[1]||(t[1]=v=>a.$emit("tab",1))}),p("label",be,[H(a.$slots,"tab2",{},void 0,!0)]),t[2]||(t[2]=p("div",{class:"line"},null,-1))]))}},$e=F(Se,[["__scopeId","data-v-9576643e"]]),ke={class:"checkbox-cont"},ge={__name:"checkbox",props:{checkmarked:Boolean},setup(u){const a=()=>event.target.classList.toggle("checkmarked");return(t,v)=>(c(),h("div",ke,[p("div",{class:I(["checkmark",u.checkmarked?"checkmarked":""]),onClick:a},null,2)]))}},ye=["item"],Ce={__name:"scrollbar",props:{orderedSpellsList:Array,beingScrolled:Boolean,list:Array},emits:["update:modelValue"],setup(u,{emit:a}){const t=u,v=a,o=E(),m=["Publicação"],e=s=>{if(!o.sortBy||m.includes(o.sortBy))return null;if(o.sortBy==="Nome")return P(s.Nome.charAt(0));if(o.sortBy==="Escola")return P(s.Escola.substring(0,4));if(o.sortBy==="Adicionada em..."){const d=new Map(t.list.map(f=>[f.id,f.history])).get(s.id),n=new Date(d);return d?`${n.getDate()}/${n.getMonth()+1}/${n.getFullYear()}`:null}return s[o.sortBy]},r=x(()=>t.orderedSpellsList?t.orderedSpellsList.map((s=>l=>!s.has(e(l))&&s.add(e(l))?e(l):null)(new Set)):[]);let _=null;const i=x(()=>t.beingScrolled),S=()=>{_&&clearTimeout(_),_=setTimeout(()=>v("update:modelValue",!1),2e3)};return z(i,s=>{s&&S()}),(s,l)=>(c(),h("div",{class:I(["scrollBar",{viewBar:i.value}])},[(c(!0),h(A,null,N(r.value,(d,n)=>(c(),h("div",{key:`scrollbar-${n}-${d}`,class:"scrollItem",item:d},null,8,ye))),128))],2))}},xe={key:0},we={class:"item"},Le=["onClick"],Ve=["innerHTML"],Te={class:"item-subtitle"},Be={class:"item-icon"},Ae={__name:"list",props:{list:{type:Array,required:!0},activeTab:{type:Boolean,default:!1},purpose:String},emits:["add_remove"],setup(u){le(f=>({"7a65233b":n.value}));const a=u,t=R(),v=C(null);G(async()=>{v.value=await t.fetchSpells()});const m=J(),e=f=>m.push(`/magias/${f}`),r=O(a.purpose)(),_=x(()=>v.value?r.filterSearch(v,a.activeTab,a.list):[]),i=E(),S=C([]);z(()=>[i.sortBy,i.reverse,_.value],()=>{S.value=i.sorter(a.list,_.value,"spells")},{deep:!0});const s=C(!1),l=()=>s.value=!0,d=f=>f<2?1:f<3?3:f<4?6:f<5?10:15,n=x(()=>`${a.activeTab?"-":""}25%`);return(f,V)=>v.value?(c(),w(B,{key:1,class:"grow"},{default:$(()=>[L(oe,{tag:"div",name:"slide",class:"overflow",onScroll:l},{default:$(()=>[(c(!0),h(A,null,N(S.value,b=>(c(),h("div",{class:"item-cont",key:`spell-${b.id}`},[p("div",we,[L(ge,{onClick:M=>f.$emit("add_remove",b.id),checkmarked:!u.activeTab},null,8,["onClick","checkmarked"]),p("div",{class:"item-click",onClick:M=>e(b.id)},[p("p",{class:"item-title",innerHTML:b.Nome},null,8,Ve),p("p",Te,g(`${d(b.Círculo)} PM${b.Círculo>1?"s":""} • ${b.Tipo} • ${b.Escola} ${b.Círculo}`),1),p("div",Be,[p("div",{class:I(`ac_${b.Ação}`)},null,2)])],8,Le)])]))),128))]),_:1}),L(Ce,{orderedSpellsList:S.value,list:u.list,beingScrolled:s.value,modelValue:s.value,"onUpdate:modelValue":V[0]||(V[0]=b=>s.value=b)},null,8,["orderedSpellsList","list","beingScrolled","modelValue"])]),_:1})):(c(),h("p",xe,"Carregando lista de magias..."))}},q=F(Ae,[["__scopeId","data-v-c773d3c9"]]),Ne={__name:"lista",props:{purpose:String},setup(u){const a=u,t=D(),v=t.charSpells,o=O(a.purpose)(),m=x(()=>o.numberCharList),e=x(()=>o.numberFullList),r=C(),_=S=>r.value=S,i=S=>t.addRemoveSpell(S);return(S,s)=>(c(),w(B,null,{default:$(()=>[s[0]||(s[0]=p("h2",null,"Magias",-1)),L($e,{onTab:_},{tab1:$(()=>[y("Pessoal ("+g(m.value)+")",1)]),tab2:$(()=>[y("Restantes ("+g(e.value)+")",1)]),_:1}),r.value?(c(),w(q,{key:1,activeTab:!0,list:k(v),onAdd_remove:i,purpose:a.purpose},null,8,["list","purpose"])):(c(),w(q,{key:0,list:k(v),onAdd_remove:i,purpose:a.purpose},null,8,["list","purpose"]))]),_:1}))}},Me={class:"tac"},Pe={class:"grow"},je={class:"flex-over overflow"},Ee={key:0},Fe=["innerHTML"],Oe=["innerHTML"],He={key:1},Ie={__name:"detalhes",props:{purpose:String},setup(u){const a=u,t=re(),v=J(),o=()=>v.push(`${v.currentRoute.value.path}/editar`),m=R(),e=C(null);G(async()=>{e.value=await m.fetchSpells()});const _=O(a.purpose)(),i=x(()=>_.filterList(e,0,[{id:Number(t.params.id)}])[0]),S=l=>l<2?1:l<3?3:l<4?6:l<5?10:15,s=l=>isNaN(l)?l:`${l} PM${l>1?"s":""}`;return(l,d)=>i.value?(c(),w(B,{key:0},{default:$(()=>[p("h2",null,g(i.value.Nome),1),p("p",Me,g(`${S(i.value.Círculo)} PM${i.value.Círculo>1?"s":""} • ${i.value.Tipo} • ${i.value.Escola} ${i.value.Círculo}`),1),p("div",Pe,[p("div",je,[j("",!0),(c(!0),h(A,null,N(i.value,(n,f)=>(c(),h("div",{key:f},[k(te).spells.includes(f)?j("",!0):(c(),h("p",Ee,[p("b",null,g(f==="Descrição"?"":`${f}:`),1),d[1]||(d[1]=y()),p("span",{innerHTML:n},null,8,Fe)]))]))),128)),(c(!0),h(A,null,N(i.value.mod,n=>(c(),h("p",null,[p("b",null,g(s(Object.keys(n).join()))+":",1),d[2]||(d[2]=y()),p("span",{innerHTML:n[Object.keys(n)]},null,8,Oe)]))),256)),i.value.Publicação?(c(),h("p",He,[d[3]||(d[3]=p("i",null,"Publicação:",-1)),y(" "+g(Array.isArray(i.value.Publicação)?i.value.Publicação.join(", "):i.value.Publicação),1)])):j("",!0)])])]),_:1})):(c(),w(B,{key:1,class:"h100"},{default:$(()=>d[4]||(d[4]=[p("p",{class:"tac"},"Clique em uma magia para ver e editar",-1)])),_:1}))}},ze={__name:"Magias",setup(u){const a=[fe,Ne,Ie];return(t,v)=>(c(),w(se,{components:a,purpose:"spells"}))}};export{ze as default};
